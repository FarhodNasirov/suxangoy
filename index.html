<!doctype html>

<html lang="en">

  <head>

    <!-- Нормализационные стили -->
    <link rel="stylesheet" href="css/normalize.css">

    <!-- Обязательные метатеги -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">

    <!-- Google fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">

    <!-- Мои стили -->
    <link rel="stylesheet" href="css/styles.css">

    <title>Suxangoy</title>

    <script type="text/javascript">

      let url = "https://script.google.com/macros/s/AKfycbz5Z28i_uAV9wPF-zgGrOeb2mnXRybnZ4SaD8iOUViI0iQPIs_8iv4Z8m9fmSyw7V2-0A/exec";

      function addURLParam(url, name, value) {
        url += (url.indexOf("?") == -1 ? "?" : "&");
        url += encodeURIComponent(name) + "=" + encodeURIComponent(value);
        return url;
      };

      async function getResponse(lesson) {
        url = addURLParam(url, "lesson", lesson);
        let response = await fetch(url).then((response) => response.json());
        return response;
      };

    </script>
  </head>

  <body>

    <!-- Навигационный бар -->
    <nav class="navbar navbar-expand-lg bg-body-tertiary">
      <div class="container-fluid">
        <h2 class="navbar-brand">Suxangoy</h2>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <label>Dars raqami: </label>
          <input id="lesson" name="lesson" value="" type="text">
          <input id="okay" type="button" value="Ok" data-bs-toggle="modal" data-bs-target="#exampleModalToggle" data-bs-whatever="0">
        </div>
      </div>
    </nav>

    <!-- Модальные окна -->
    <div class="modal fade" id="exampleModalToggle" aria-hidden="true" aria-labelledby="exampleModalToggleLabel" tabindex="-1">  
      <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header bg-secondary text-white">
            <h2 class="modal-title fs-5" id="exampleModalToggleLabel">Sarlavha</h2>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <h1 id="englishWord">Interesting</h1>
          </div>
          <div class="modal-footer">
            <button class="btn btn-primary" data-bs-target="#exampleModalToggle2" data-bs-toggle="modal">Tarjimasi</button>
          </div>
        </div>
      </div>
    </div>

    <div class="modal fade" id="exampleModalToggle2" aria-hidden="true" aria-labelledby="exampleModalToggleLabel2" tabindex="-1">
      <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header bg-secondary text-white">
            <h2 class="modal-title fs-5" id="exampleModalToggleLabel2">Sarlavha</h2>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <h1 id="uzbekWord">Qiziqarli</h1>
          </div>
          <div class="modal-footer">
            <button class="btn btn-primary" data-bs-target="#exampleModalToggle" data-bs-toggle="modal">Keyingi so'z</button>
          </div>
        </div>
      </div>
    </div>

    <!-- пакет Bootstrap с Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script>

    <!-- собственный скрипт -->
    <script>

      let wordsDB = getResponse(lesson.value);
      const exampleModalToggle = document.getElementById("exampleModalToggle")
      const exampleModalToggle2 = document.getElementById("exampleModalToggle2")
      let index = 0
      if (exampleModalToggle) {
        exampleModalToggle.addEventListener("show.bs.modal", event => {
          const button = event.relatedTarget
          index = 0 + button.getAttribute("data-bs-whatever")
          const word = showDB(index).english
          const modalLabel = exampleModalToggle.querySelector(".exampleModalToggleLabel")
          const modalwordid = exampleModalToggle.querySelector(".modal-body #englishWord")
          modalLabel.textContent = index + 1 + "-chi so'z"
          modalwordid.textContent = word
          // index += 1
          const next = exampleModalToggle.querySelector(".modalfooter .btn-primary")
          next.setAttribute("data-bs-whatever") = index
        })
      }
      if (exampleModalToggle2) {
      exampleModalToggle2.addEventListener("show.bs.modal", event => {
        const button = event.relatedTarget
        index = 0 + button.getAttribute("data-bs-whatever")
        const word = showDB(index).uzbek
        const modalLabel = exampleModalToggle2.querySelector(".exampleModalToggleLabel2")
        const modalwordid = exampleModalToggle2.querySelector(".modal-body #uzbekWord")
        modalLabel.textContent = index + 1 + "-chi so'z tarjimasi"
        modalwordid.textContent = word
        index += 1
        const next = exampleModalToggle2.querySelector(".modalfooter .btn-primary")
        next.setAttribute("data-bs-whatever") = index
        })
      }

      function showDB(index) {
        let list = wordsDB.then((data) => {
          if (index in data.dictionary)
            return data.dictionary[index]
        })
        return list
      }
  
      // function clickme() {
      //   document.getElementById("okay").addEventListener("click", showDB, false)
      // }
  
      // window.addEventListener("load", clickme, false);
  
    </script>
  
  </body>

</html>
